# =============================================================================
# OpenAPI 3.0 API ë¬¸ì„œ
# =============================================================================
#
# ì²­ë…„ ì •ì±… ì¶”ì²œ ì‹œìŠ¤í…œ API ëª…ì„¸ì„œì…ë‹ˆë‹¤.
# Swagger UIë¡œ ì‹œê°í™”í•˜ê±°ë‚˜ API í´ë¼ì´ì–¸íŠ¸ ìƒì„±ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
#
# Author: Youth Policy System Team
# Version: 1.0.0
# =============================================================================

openapi: 3.0.3

# =============================================================================
# API ê¸°ë³¸ ì •ë³´
# =============================================================================
info:
  title: ì²­ë…„ ì •ì±… ì¶”ì²œ ì‹œìŠ¤í…œ API
  description: |
    AI ê¸°ë°˜ ì²­ë…„ ì •ì±… ì¶”ì²œ ì‹œìŠ¤í…œì˜ REST APIì…ë‹ˆë‹¤.

    ## ì£¼ìš” ê¸°ëŠ¥
    - ì‚¬ìš©ì ì •ë³´ ê¸°ë°˜ ë§ì¶¤í˜• ì •ì±… ì¶”ì²œ
    - ì •ì±… ê²€ìƒ‰ ë° ìƒì„¸ ì¡°íšŒ
    - ì‹œìŠ¤í…œ ìƒíƒœ ëª¨ë‹ˆí„°ë§

    ## ì¸ì¦
    í˜„ì¬ ë²„ì „ì—ì„œëŠ” ì¸ì¦ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” API Key ë˜ëŠ” OAuth 2.0ì„ ì‚¬ìš©í•˜ì„¸ìš”.

    ## ì‘ë‹µ í˜•ì‹
    ëª¨ë“  ì‘ë‹µì€ JSON ë˜ëŠ” Markdown í˜•ì‹ì…ë‹ˆë‹¤.

  version: 1.0.0
  contact:
    name: Youth Policy System Team
    email: support@youth-policy.example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

# =============================================================================
# ì„œë²„ ì„¤ì •
# =============================================================================
servers:
  - url: http://localhost:5678
    description: ë¡œì»¬ ê°œë°œ ì„œë²„
  - url: https://api.youth-policy.example.com
    description: í”„ë¡œë•ì…˜ ì„œë²„

# =============================================================================
# íƒœê·¸ ì •ì˜
# =============================================================================
tags:
  - name: ì •ì±… ì¶”ì²œ
    description: ë§ì¶¤í˜• ì •ì±… ì¶”ì²œ API
  - name: ì •ì±… ì¡°íšŒ
    description: ì •ì±… ê²€ìƒ‰ ë° ìƒì„¸ ì¡°íšŒ
  - name: ì‹œìŠ¤í…œ
    description: ì‹œìŠ¤í…œ ìƒíƒœ ë° ëª¨ë‹ˆí„°ë§

# =============================================================================
# API ê²½ë¡œ ì •ì˜
# =============================================================================
paths:
  # ===========================================================================
  # ì •ì±… ì¶”ì²œ ì—”ë“œí¬ì¸íŠ¸
  # ===========================================================================
  /webhook/youth-policy:
    post:
      tags:
        - ì •ì±… ì¶”ì²œ
      summary: ë§ì¶¤í˜• ì •ì±… ì¶”ì²œ
      description: |
        ì‚¬ìš©ìì˜ ìì—°ì–´ ì…ë ¥ì„ ë¶„ì„í•˜ì—¬ ì í•©í•œ ì²­ë…„ ì •ì±…ì„ ì¶”ì²œí•©ë‹ˆë‹¤.

        ## ì²˜ë¦¬ ê³¼ì •
        1. ìì—°ì–´ ì…ë ¥ì„ êµ¬ì¡°í™”ëœ JSONìœ¼ë¡œ ë³€í™˜
        2. Vector DBì—ì„œ ê´€ë ¨ ì •ì±… ê²€ìƒ‰
        3. LLMì„ í†µí•œ ê²€ì¦ ë° í•„í„°ë§
        4. ë§ˆí¬ë‹¤ìš´ í˜•ì‹ì˜ ì¶”ì²œ ê²°ê³¼ ìƒì„±

        ## ì‘ë‹µ ì‹œê°„
        í‰ê·  3-5ì´ˆ ì†Œìš”
      operationId: recommendPolicies
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecommendationRequest'
            examples:
              ëŒ€ì¶œ_ê°ˆì•„íƒ€ê¸°:
                summary: ëŒ€ì¶œ ê°ˆì•„íƒ€ê¸° ìš”ì²­
                value:
                  userInput: "ì„œìš¸ ì‚¬ëŠ” 29ì„¸ ì§ì¥ì¸ì´ê³ , ì—°ë´‰ì€ 4ì²œë§Œ ì›ì´ì•¼. ì§€ê¸ˆ ê³ ê¸ˆë¦¬ ëŒ€ì¶œì„ ì €ê¸ˆë¦¬ ì²­ë…„ ëŒ€ì¶œë¡œ ê°ˆì•„íƒ€ê³  ì‹¶ì–´."
              ìì‚°_í˜•ì„±:
                summary: ìì‚° í˜•ì„± ìš”ì²­
                value:
                  userInput: "ë¶€ì‚°ì— ì‚¬ëŠ” 25ì‚´ ëŒ€í•™ìƒì…ë‹ˆë‹¤. ì €ì¶•ë„ í•˜ê³  ì‹¶ê³  ë‚˜ì¤‘ì— ì°½ì—…ë„ ìƒê°í•˜ê³  ìˆì–´ìš”."
      responses:
        '200':
          description: ì¶”ì²œ ì„±ê³µ
          content:
            text/markdown:
              schema:
                type: string
              example: |
                # ğŸ¯ 2025ë…„ë„ ë§ì¶¤í˜• ì²­ë…„ ì •ì±… ì¶”ì²œ

                **ê³ ê°**ë‹˜ì˜ ì¡°ê±´ì— ë¶€í•©í•˜ëŠ” ìœ íš¨í•œ ì •ì±…ì…ë‹ˆë‹¤.

                | ì •ì±…ëª… | ì§€ì› ë‚´ìš© | ìê²© ì¡°ê±´ |
                |--------|----------|----------|
                | ì²­ë…„ ì „ìš© ëŒ€í™˜ëŒ€ì¶œ | ê³ ê¸ˆë¦¬ ëŒ€ì¶œì„ ì €ê¸ˆë¦¬ë¡œ ì „í™˜ | ë§Œ 19~34ì„¸ |
        '400':
          description: ì˜ëª»ëœ ìš”ì²­
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: ì„œë²„ ì˜¤ë¥˜
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  # ===========================================================================
  # í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
  # ===========================================================================
  /healthz:
    get:
      tags:
        - ì‹œìŠ¤í…œ
      summary: í—¬ìŠ¤ì²´í¬
      description: ì‹œìŠ¤í…œ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.
      operationId: healthCheck
      responses:
        '200':
          description: ì‹œìŠ¤í…œ ì •ìƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'
        '503':
          description: ì‹œìŠ¤í…œ ë¹„ì •ìƒ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'

  # ===========================================================================
  # ë©”íŠ¸ë¦­ ì—”ë“œí¬ì¸íŠ¸
  # ===========================================================================
  /metrics:
    get:
      tags:
        - ì‹œìŠ¤í…œ
      summary: Prometheus ë©”íŠ¸ë¦­
      description: Prometheus í˜•ì‹ì˜ ë©”íŠ¸ë¦­ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
      operationId: getMetrics
      responses:
        '200':
          description: ë©”íŠ¸ë¦­ ë°˜í™˜
          content:
            text/plain:
              schema:
                type: string

# =============================================================================
# ì»´í¬ë„ŒíŠ¸ ì •ì˜
# =============================================================================
components:
  # ===========================================================================
  # ìŠ¤í‚¤ë§ˆ
  # ===========================================================================
  schemas:
    RecommendationRequest:
      type: object
      required:
        - userInput
      properties:
        userInput:
          type: string
          description: ì‚¬ìš©ìì˜ ìì—°ì–´ ì…ë ¥
          minLength: 10
          maxLength: 1000
          example: "ì„œìš¸ ì‚¬ëŠ” 29ì„¸ ì§ì¥ì¸ì´ê³ , ì—°ë´‰ì€ 4ì²œë§Œ ì›ì´ì•¼."

    UserInfo:
      type: object
      description: êµ¬ì¡°í™”ëœ ì‚¬ìš©ì ì •ë³´
      properties:
        age:
          type: integer
          description: ë§Œ ë‚˜ì´
          example: 29
        location:
          type: string
          description: ê±°ì£¼ ì§€ì—­
          example: "ì„œìš¸"
        income_annual:
          type: integer
          description: ì—°ì†Œë“ (ì›)
          example: 40000000
        employment_status:
          type: string
          description: ì§ì—… ìƒíƒœ
          enum: [ì§ì¥ì¸, í•™ìƒ, ë¬´ì§, ìì˜ì—…, í”„ë¦¬ëœì„œ]
        needs:
          type: array
          items:
            type: string
          description: ì‚¬ìš©ì ë‹ˆì¦ˆ
        interest_areas:
          type: array
          items:
            type: string
          description: ê´€ì‹¬ ë¶„ì•¼

    PolicyInfo:
      type: object
      description: ì •ì±… ì •ë³´
      properties:
        policy_name:
          type: string
          description: ì •ì±…ëª…
        policy_category:
          type: string
          description: ì •ì±… ì¹´í…Œê³ ë¦¬
        support_details:
          type: string
          description: ì§€ì› ë‚´ìš©
        eligibility:
          type: string
          description: ìê²© ì¡°ê±´
        required_documents:
          type: array
          items:
            type: string
          description: í•„ìˆ˜ ì„œë¥˜
        official_link:
          type: string
          format: uri
          description: ê³µì‹ ë§í¬

    HealthStatus:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        components:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              status:
                type: string
              latency_ms:
                type: number

    Error:
      type: object
      properties:
        error:
          type: string
          description: ì˜¤ë¥˜ ì½”ë“œ
        message:
          type: string
          description: ì˜¤ë¥˜ ë©”ì‹œì§€
        details:
          type: object
          description: ì¶”ê°€ ì •ë³´
